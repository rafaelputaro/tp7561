services:
{% for i in range(1, number_of_pairs + 1) %}
  peer-{{ i }}:
    container_name: peer-{{ i }}
    image: peer:latest
    environment:
      - NODE_NAME=peer-{{ i }}
    networks:
      - tp_net
    depends_on:
{% for i in range(i+1, number_of_pairs + 1) %}
      - peer-{{ i }}
{%- endfor -%}
{% endfor %}